@inherits LayoutComponentBase

<MudRTLProvider Style="height:100% !important;" RightToLeft="IsRightToLeft">
    <div style="height:100% !important;@(CurrentCulture == "ar-EG" ? "font-family: 'Noto Sans Arabic', sans-serif !important;" : string.Empty)" class="d-flex flex-column flex-root" id="kt_app_root">
        <MudThemeProvider Theme="MyCustomTheme" @bind-IsDarkMode="IsDarkMode" />
        <MudDialogProvider />
        <MudSnackbarProvider />
        <!--begin::Authentication - Sign-in -->
        <div class="d-flex flex-column flex-lg-row flex-column-fluid">
            <!--begin::Aside-->
            <div class="d-flex flex-column justify-center flex-lg-row-auto bg-success w-xl-600px positon-xl-relative">
                <!--begin::Wrapper-->
                <div class="d-flex flex-column top-0 bottom-0 w-xl-600px">
                    <!--begin::Header-->
                    <div class="d-flex flex-row-fluid flex-column text-center p-5 p-lg-10 pt-lg-20">
                        <!--begin::Title-->
                        <h1 class="d-none d-lg-block fw-bold text-white fs-2qx pb-5 pb-md-10">
                            @languageContainer.Keys["Welcome to"] Pest Sweepy
                        </h1>
                        <!--end::Title-->
                        <!--begin::Description-->
                        <p class="d-none d-lg-block fw-semibold fs-2 text-white">
                            @languageContainer.Keys["We provide you with the best quality, according to international standards, for cleaning services, pest extermination, and home and hotel services."]
                        </p>
                        <!--end::Description-->
                    </div>
                    <!--end::Header-->
                    <!--begin::Illustration-->
                    <div class="d-none d-lg-block flex-row-auto bgi-no-repeat bgi-position-x-center bgi-size-contain bgi-position-y-bottom min-h-100px min-h-lg-300px" style="background-image: url(images/LogoOnly.png)"></div>
                    <!--end::Illustration-->
                </div>
                <!--end::Wrapper-->
            </div>
            <!--begin::Aside-->
            <!--begin::Body-->
            <div class="d-flex flex-column flex-lg-row-fluid py-10">
                <!--begin::Content-->
                <div class="d-flex flex-center flex-column flex-column-fluid">
                    <!--begin::Wrapper-->
                    <div class="w-lg-500px p-10 p-lg-15 mx-auto">
                        @Body
                    </div>
                    <!--end::Wrapper-->
                </div>
                <!--end::Content-->
            </div>
            <!--end::Body-->
        </div>
        <!--end::Authentication - Sign-in-->
    </div>
</MudRTLProvider>

@code {

    [Inject] IJSRuntime JSRuntime { get; set; } = default!;
    [Inject] ILocalStorageService LocalStorage { get; set; } = default!;

    private string CurrentCulture = string.Empty;
    private bool IsDarkMode;
    private bool IsRightToLeft = false;
    MudTheme MyCustomTheme = new MudTheme();

    protected override async Task OnInitializedAsync()
    {
        CurrentCulture = await LocalStorage.GetItemAsync<string>("CurrentCulture");

        if (CurrentCulture == "ar-EG")
        {
            IsRightToLeft = true;
            MyCustomTheme = new()
                {
                    Typography = new Typography()
                    {
                        Default = new Default() { FontFamily = new[] { "Noto Sans Arabic", "sans-serif" } },
                    }
                };
        }

        await SetThemeModeAsync();
    }

    private async Task SetThemeModeAsync()
    {
        IsDarkMode = await LocalStorage.GetItemAsync<string>("data-bs-theme") == "light" ? false : true;
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await JSRuntime.InvokeVoidAsync("KTThemeModeUser.init");
        await JSRuntime.InvokeVoidAsync("KTThemeMode.init");
        await JSRuntime.InvokeVoidAsync("KTComponents.init");
    }
}