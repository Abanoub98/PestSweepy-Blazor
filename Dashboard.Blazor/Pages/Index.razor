@page "/"
@inherits BasePage
@attribute [Authorize]

<PageTitle>@languageContainer.Keys["Home"]</PageTitle>

@if (isLoading)
{
    
}
else
{
    <div class="row mb-3">
        <div class="col-md-7 col-12 mb-md-0 mb-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <MudCard Class="bg-transparent" Elevation="0">
                        <MudCardHeader>
                            <CardHeaderContent>
                                <MudText Typo="Typo.h5">Current User</MudText>
                            </CardHeaderContent>
                        </MudCardHeader>
                        <MudCardContent>
                            <div class="row">
                                <div class="col-md-6 col-12">
                                    <div class="d-flex flex-wrap">
                                        <div class="p-3 w-50 w-md-100">
                                            <MudText Class="fw-bold" Typo="Typo.body1">Email</MudText>
                                            <MudText>@claims.FirstOrDefault(x => x.Type == ClaimTypes.Email)?.Value</MudText>
                                        </div>
                                        <div class="p-3 w-50 w-md-100">
                                            <MudText Class="fw-bold" Typo="Typo.body1">Login Date</MudText>
                                            <MudText>@(claims.FirstOrDefault(x => x.Type == "LoginDate")?.Value)</MudText>
                                        </div>
                                        <div class="p-3 w-50">
                                            <MudText Class="fw-bold" Typo="Typo.body1">Role</MudText>
                                            <MudText>@claims.FirstOrDefault(x => x.Type == ClaimTypes.Role)?.Value</MudText>
                                        </div>
                                        <div class="p-3 w-50">
                                            <MudText Class="fw-bold" Typo="Typo.body1">IP Address</MudText>
                                            <MudText>@(claims.FirstOrDefault(x => x.Type == "IpAddress")?.Value)</MudText>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12 mt-5 mt-md-5 text-center">
                                    <MudImage Src="/images/home-office.png" Fluid="true" Class="rounded-lg" />
                                </div>
                            </div>
                        </MudCardContent>
                    </MudCard>
                </div>
            </div>
        </div>
    </div>
    <div class="my-10 d-flex justify-content-center align-items-center">
        <MudImage Src="/images/Logo.png" Width="300" ObjectFit="ObjectFit.Contain" Class="rounded-lg ma-4" />
    </div>
}


@code {
    private IEnumerable<Claim> claims = Enumerable.Empty<Claim>();

    protected override async Task OnInitializedAsync()
    {
        StartProcessing();

        claims = await GetClaimsPrincipalData();

        StopProcessing();
    }
}