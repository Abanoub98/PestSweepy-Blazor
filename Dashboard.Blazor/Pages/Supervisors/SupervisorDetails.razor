@page "/Supervisors/Details/{Id:int}"
@attribute [Authorize(Roles = $"{Roles.AdminRole},{Roles.ManagerRole}")]
@inherits BasePage

<PageTitle>
    @($"{languageContainer.Keys["Supervisor"]} {languageContainer.Keys["Details"]}")
</PageTitle>
<MudBreadcrumbs Items="breadcrumbItems" />

@if (supervisor is null)
{
    <FormLoadingSpinner IsBigForm="true" />
}
else
{
    <div class="d-flex flex-column flex-md-row">
        <!--begin::Sidebar-->
        <div class="flex-column flex-lg-row-auto w-100 w-xl-350px mb-10">
            <!--begin::Card-->
            <div class="card mb-5 mb-xl-8 shadow-sm">
                <!--begin::Card body-->
                <div class="card-body pt-15">
                    <!--begin::Summary-->
                    <div class="d-flex flex-center flex-column">
                        <!--begin::Avatar-->
                        <MudAvatar Class="border border-gray-300" Style="height:200px; width:200px;" Rounded="true" @onclick="() => ShowImagePreview(imageUrl + supervisor.Image)" Color="Color.Primary">
                            <MudImage Src="@(imageUrl + supervisor.Image)"></MudImage>
                        </MudAvatar>
                        <!--end::Avatar-->
                        <!--begin::Name-->
                        <a class="fs-3 text-gray-800 text-hover-primary fw-bold my-2">
                            @supervisor.FirstName @supervisor.LastName
                        </a>
                        <!--end::Name-->
                        <!--begin::Position-->
                        <div class="fs-5 fw-semibold text-muted">
                            @supervisor.Email
                        </div>
                        <!--end::Position-->
                        <!--begin::Position-->
                        <div class="fs-5 fw-semibold text-muted mb-6">
                            @supervisor.PhoneNumber
                        </div>
                        <!--end::Position-->
                    </div>
                    <!--end::Summary-->
                </div>
                <!--end::Card body-->
            </div>
            <!--end::Card-->
            <div class="card shadow-sm">
                <div class="card-header border-0 cursor-pointer">
                    <div class="card-title m-0">
                        <h3 class="fw-bold m-0">@languageContainer.Keys["Account Settings"]</h3>
                    </div>
                </div>
                <!--begin::Card body-->
                <div class="card-body">
                    <!--begin::Email Address-->
                    <div class="d-flex d-md-inline flex-wrap align-items-center">
                        <!--begin::Label-->
                        <div>
                            <div class="fs-6 fw-bold mb-1">@languageContainer.Keys["Email Address"]</div>
                            <div class="fw-semibold text-gray-600">@supervisor.Email</div>
                        </div>
                        <!--end::Label-->
                        <!--begin::Action-->
                        <div class="ms-auto mt-md-3">
                            <button @onclick="() => ShowChangeEmailAsync()" class="btn btn-light-primary">@languageContainer.Keys["Change Email"]</button>
                        </div>
                        <!--end::Action-->
                    </div>
                    <!--end::Email Address-->
                    <!--begin::Separator-->
                    <div class="separator separator-dashed my-6"></div>
                    <!--end::Separator-->
                    <!--begin::Password-->
                    <div class="d-flex d-md-inline flex-wrap align-items-center mb-10">
                        <!--begin::Label-->
                        <div>
                            <div class="fs-6 fw-bold mb-1">@languageContainer.Keys["Password"]</div>
                            <div class="fw-semibold text-gray-600">************</div>
                        </div>
                        <!--end::Label-->
                        <!--begin::Action-->
                        <div class="ms-auto mt-md-3">
                            <button @onclick="() => ShowChangePasswordAsync(supervisor.UserId)" class="btn btn-light-primary">@languageContainer.Keys["Reset Password"]</button>
                        </div>
                        <!--end::Action-->
                    </div>
                    <!--end::Password-->
                </div>
                <!--end::Card body-->
            </div>
        </div>
        <!--end::Sidebar-->
        <!--begin::Content-->
        <div class="flex-lg-row-fluid ms-lg-15">
            <!--begin:::Tabs-->
            <ul class="nav nav-custom nav-tabs nav-line-tabs nav-line-tabs-2x border-0 fs-4 fw-semibold mb-8" role="tablist">
                <!--begin:::Tab item-->
                <li class="nav-item" role="presentation">
                    <a class="nav-link text-active-primary pb-4 active" data-bs-toggle="tab" href="#kt_customer_view_overview_tab" aria-selected="true" role="tab">@languageContainer.Keys["Overview"]</a>
                </li>
                <!--end:::Tab item-->
                <!--begin:::Tab item-->
                <li class="nav-item" role="presentation">
                    <a class="nav-link text-active-primary pb-4" data-bs-toggle="tab" href="#kt_customer_view_overview_events_and_logs_tab" aria-selected="false" role="tab" tabindex="-1">@languageContainer.Keys["Providers"]</a>
                </li>
                <!--end:::Tab item-->
            </ul>
            <!--end:::Tabs-->
            <!--begin:::Tab content-->
            <div class="tab-content" id="myTabContent">
                <!--begin:::Tab pane-->
                <div class="tab-pane fade active show" id="kt_customer_view_overview_tab" role="tabpanel">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="d-flex flex-stack fs-4 py-3">
                                <div class="fw-bold">
                                    @languageContainer.Keys["Details"]
                                </div>
                                <span>
                                    <a @onclick="() => OpenForm(formUri,supervisor.Id)" class="btn btn-sm btn-light-primary">
                                        @languageContainer.Keys["Edit"]
                                    </a>
                                </span>
                            </div>
                            <!--end::Details toggle-->
                            <div class="separator separator-dashed"></div>
                            <div class="d-flex justify-content-between align-items-center">
                                <!--begin::Details content-->
                                <div class="py-3 fs-6">
                                    <!--begin::Details item-->
                                    <div class="fw-bold mt-5">@languageContainer.Keys["Nationality"]</div>
                                    <div class="text-gray-600">@supervisor.Nationality?.Name</div>
                                    <!--begin::Details item-->
                                    <!--begin::Details item-->
                                    <div class="fw-bold mt-5">@languageContainer.Keys["Gender"]</div>
                                    <div class="text-gray-600">@supervisor.Gender</div>
                                    <!--begin::Details item-->
                                    <!--begin::Details item-->
                                    <div class="fw-bold mt-5">@languageContainer.Keys["Email"]</div>
                                    <div class="text-gray-600">@supervisor.Email</div>
                                    <!--begin::Details item-->
                                    <!--begin::Details item-->
                                    <div class="fw-bold mt-5">@languageContainer.Keys["Phone"]</div>
                                    <div class="text-gray-600">@supervisor.PhoneNumber</div>
                                    <!--begin::Details item-->
                                    <!--begin::Details item-->
                                    <div class="fw-bold mt-5">@languageContainer.Keys["National Id"]</div>
                                    <div class="text-gray-600">@supervisor.NationalId</div>
                                    <!--begin::Details item-->
                                    <!--begin::Details item-->
                                    <div class="fw-bold mt-5">@languageContainer.Keys["Manger"]</div>
                                    <a href="/Managers/details/@supervisor.Manager?.Id" class="text-gray-600 text-hover-primary">
                                        @($"{supervisor.Manager?.FirstName} {supervisor.Manager?.LastName}")
                                    </a>
                                    <!--begin::Details item-->
                                </div>
                                <!--end::Details content-->
                                <div>
                                    <QRCode PixelsPerModule="6" Value="@($"https://pestsweepy.com/Supervisors/Details/{Id}")" Alt="QRCode image" EccLevel="EccLevel.H" Icon="@Base64Images.Logo" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--end:::Tab pane-->
                <!--begin:::Tab pane-->
                <div class="tab-pane fade" id="kt_customer_view_overview_events_and_logs_tab" role="tabpanel">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <Providers SupervisorId="supervisor.Id" />
                        </div>
                    </div>
                </div>
                <!--end:::Tab pane-->
            </div>
            <!--end:::Tab content-->
        </div>
        <!--end::Content-->
    </div>
}
