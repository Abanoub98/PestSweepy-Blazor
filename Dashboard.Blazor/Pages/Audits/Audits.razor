@using Dashboard.Blazor.Components

@page "/Audits"
@attribute [Authorize]
@inherits BasePage<AuditDto>

<PageTitle>@languageContainer.Keys["Audits"]</PageTitle>
<MudBreadcrumbs Items="breadcrumbItems"></MudBreadcrumbs>

<MudCard Elevation="25">
    <MudCardContent>
        <MudDataGrid T="AuditDto" Dense="true" Elevation="0" FixedHeader="true" Height="300px"
                     Loading="@(isLoading)" LoadingProgressColor="Color.Info" Filterable="true"
                     Items="audits" Hover="true" SortMode="SortMode.Single" QuickFilter="@FilterFunc">

            <ToolBarContent>
                <MudText Class="me-1" Typo="Typo.h5">@languageContainer.Keys["Audits"]</MudText>
                <MudSpacer />
                <MudTextField @bind-Value="searchString" Adornment="Adornment.Start" Class="mt-0" Immediate="true"
                              Placeholder=@($"{languageContainer.Keys["SearchFor"]} User Id, Type, Table Name, Date")
                              AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"/>
            </ToolBarContent>
            <NoRecordsContent>
                <NoDataToDisply />
            </NoRecordsContent>
            <Columns>
                <PropertyColumn Property="x => x.UserId" Title="User Id" />
                <PropertyColumn Property="x => x.Type" />
                <PropertyColumn Property="x => x.TableName" Title="Table Name" />
                <PropertyColumn Property="x => x.DateTime.ToString()" Title="Date Time" />
                <TemplateColumn Context="audit" Sortable="false" Filterable="false">
                    <CellTemplate>
                        <MudButtonGroup Size="Size.Small" Color="Color.Info" Variant="Variant.Outlined">
                            <MudIconButton OnClick="() => ShowAuditDetailsDialog(audit.Item!.Id)" Disabled="isDisable" Icon="@Icons.Material.Filled.Info" />
                        </MudButtonGroup>
                    </CellTemplate>
                </TemplateColumn>
            </Columns>

            <PagerContent>
                <MudDataGridPager T="AuditDto" />
            </PagerContent>
        </MudDataGrid>
    </MudCardContent>
</MudCard>
